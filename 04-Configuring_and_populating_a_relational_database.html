

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>9. Configuring and populating a relational database &#8212; Data Science</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-E6W9FJFWE8"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-E6W9FJFWE8');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '04-Configuring_and_populating_a_relational_database';</script>
    <link rel="canonical" href="python2024/04-Configuring_and_populating_a_relational_database.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="11. Configuring and populating a graph database" href="05-Configuring_and_populating_a_graph_database.html" />
    <link rel="prev" title="7. Introduction to Pandas" href="03-Introduction_to_Pandas.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Data Science - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Data Science - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    Data Science
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="00-Introduction_to_the_course_and_final_project_specifications.html">1. Introduction to the course and final project specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="01-What_is_a_datum_and_how_it_can_be_represented_computationally.html">2. What is a datum and how it can be represented computationally</a></li>
<li class="toctree-l1"><a class="reference internal" href="01-Data_formats_and_methods_for_storing_data_in_Python.html">3. Data formats and methods for storing data in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-Implementation_of_data_models_via_Python_classes.html">5. Implementation of data models via Python classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-Introduction_to_Pandas.html">7. Introduction to Pandas</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">9. Configuring and populating a relational database</a></li>
<li class="toctree-l1"><a class="reference internal" href="05-Configuring_and_populating_a_graph_database.html">11. Configuring and populating a graph database</a></li>
<li class="toctree-l1"><a class="reference internal" href="06-Interacting_with_databases_using_Pandas.html">13. Interacting with databases using Pandas</a></li>
<li class="toctree-l1"><a class="reference internal" href="07-Descriptive_statistics_and_graphs_about_data_using_Pandas.html">15. Descriptive statistics and graphs about data using Pandas</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/mary-lev/data_science/blob/gh-pages/_sources/04-Configuring_and_populating_a_relational_database.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>



<a href="https://github.com/mary-lev/data_science" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/04-Configuring_and_populating_a_relational_database.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>9. Configuring and populating a relational database</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sqlite">SQLite</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-database">Create a new database</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-a-diagram-to-tables">From a diagram to tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-create-and-populate-a-table-with-pandas">How to create and populate a table with Pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#venue-id-table">Venue-Id table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-for-journals-and-books">Tables for journals and books</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-for-publications">Tables for publications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-the-tables-to-the-database">Adding the tables to the database</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="configuring-and-populating-a-relational-database">
<h1>9. Configuring and populating a relational database<a class="headerlink" href="#configuring-and-populating-a-relational-database" title="Permalink to this heading">#</a></h1>
<p>In this tutorial we introduce how to use <a class="reference external" href="https://en.wikipedia.org/wiki/SQLite">SQLite</a> in Python.</p>
<section id="sqlite">
<h2>SQLite<a class="headerlink" href="#sqlite" title="Permalink to this heading">#</a></h2>
<p><a class="reference external" href="https://www.sqlite.org">SQLite</a> is a relational database management system (RDBMS) which can be embedded into the end program and does not follow a classic client–server architecture, where the server database is independent and is actually accessed by client programs.</p>
<p>Python includes <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html">SQLite within its standard library</a> - it means that you can create and modify SQLite database directly from Python code. This simplifies a lot the first approach to DBMS, as we will see in the following sections. In addition, there are already several <a class="reference external" href="https://www.digitalocean.com/community/tutorials/how-to-use-the-sqlite3-module-in-python-3">documents on how to use SQLite in Python</a> that are worth of reading to get more details about the features it provides. In this tutorial, we will see the main constructs used to create a database and populate it with tables.</p>
</section>
<section id="create-a-new-database">
<h2>Create a new database<a class="headerlink" href="#create-a-new-database" title="Permalink to this heading">#</a></h2>
<p>First of all, we have to import functions defined in the <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html"><code class="docutils literal notranslate"><span class="pre">sqlite3</span></code> package</a> in order to use its classes to create and execute operations on a database. The first thing we need, in particular, is to use the <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection">class <code class="docutils literal notranslate"><span class="pre">Connection</span></code></a>. This class is responsible to connect to a particular database defined as a file. In SQLite, any database is actually stored in one single <code class="docutils literal notranslate"><span class="pre">.db</span></code> file. A new object having class <code class="docutils literal notranslate"><span class="pre">Connection</span></code> is created by calling the <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.connect">function <code class="docutils literal notranslate"><span class="pre">connect</span></code></a>, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sqlite3</span> <span class="kn">import</span> <span class="n">connect</span>

<span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s2">&quot;publications.db&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="c1"># do some operation with the new connection</span>
    
    <span class="n">con</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>  <span class="c1"># commit the current transaction to the database</span>
    
    <span class="c1"># when you finish, the collection will be closed automatically via &#39;with&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>As you can see, the way we use a new connection to a database is similar to what we have seen with files in previous tutorials, using the instruction <code class="docutils literal notranslate"><span class="pre">with</span></code> that allows us to close the connection to the database when all the operations with it have been executed. Before closing the connection, though, it is crucial to run the <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.commit">method <code class="docutils literal notranslate"><span class="pre">commit</span></code></a> in order to commit the current <a class="reference external" href="https://en.wikipedia.org/wiki/Database_transaction">transaction</a> (i.e. the set of operations that may have changed the status of a database) to the database itself. Of course, it is possible to call the method <code class="docutils literal notranslate"><span class="pre">commit</span></code> more than once during the lifespan of a connection. In practice, you can call it every time you execute an operation that modifies the status of the database, in order to record such modification into the file system.</p>
<p>It is worth mentioning that the <code class="docutils literal notranslate"><span class="pre">.db</span></code> file specifed as input of the function <code class="docutils literal notranslate"><span class="pre">connect</span></code> is created if no database is available with that name in the path specified. However, if such a file already exists, it will be loaded by the connection with the information it already stores.</p>
</section>
<section id="from-a-diagram-to-tables">
<h2>From a diagram to tables<a class="headerlink" href="#from-a-diagram-to-tables" title="Permalink to this heading">#</a></h2>
<p>Before starting populating the database, it is necessary to create the appropriate tables that enable the description of all the entities (and related data) we need. In order to understand what to do, it is important to look at the UML diagram describing the data model introduced in a previous tutorial.</p>
<p><img alt="UML diagram of a data model" src="_images/uml.png" /></p>
<p>There are different strategies that we can follow to crete the tables describing a data model such as that deiscribed above. For instance, we can approach such a translation as follows:</p>
<ul class="simple">
<li><p>Create a table for each class which does not have any subclass (i.e. the most concrete classes), by using as columns all single-valued attributes and relations defined in such a class and all its superclasses. Concretely, we create four tables, i.e. for <code class="docutils literal notranslate"><span class="pre">JournalArticle</span></code> and <code class="docutils literal notranslate"><span class="pre">BookChapter</span></code> (which inherit all the attributes and relations of <code class="docutils literal notranslate"><span class="pre">Publication</span></code>), and <code class="docutils literal notranslate"><span class="pre">Journal</span></code> and <code class="docutils literal notranslate"><span class="pre">Book</span></code> (which inherit all the attributes and relations of <code class="docutils literal notranslate"><span class="pre">Venue</span></code>).</p></li>
<li><p>For each of the tables above, add also a new column that enables us to specify an internal identifier we use to clearly identify all the entities of the various types. In this case, it is enough to add an additional column in each table, e.g. <code class="docutils literal notranslate"><span class="pre">internalId</span></code>. Suggestion: having an internal identifier which is globally unique in the database is the way to go.</p></li>
<li><p>Keep in mind that the value of all the columns related to relations must point to an internal identifier defined in some of the tables. For instance, the column <code class="docutils literal notranslate"><span class="pre">publicationVenue</span></code> in the table <code class="docutils literal notranslate"><span class="pre">JournalArticle</span></code> will contain an internal identifier of a journal as defined in the column <code class="docutils literal notranslate"><span class="pre">internalId</span></code> of the table <code class="docutils literal notranslate"><span class="pre">Journal</span></code>.</p></li>
<li><p>Create a two column table, where the first column enables the identification of an internal identifier of an entity specified in the other tables, for each multivalued attribute or relation in the diagram. In the example, only the attribute <code class="docutils literal notranslate"><span class="pre">id</span></code> of the class <code class="docutils literal notranslate"><span class="pre">Venue</span></code> is multivalued, and thus an additional table <code class="docutils literal notranslate"><span class="pre">VenueId</span></code> is created to link a <code class="docutils literal notranslate"><span class="pre">Venue</span></code> entity with one or more identifiers characterising it.</p></li>
</ul>
<p>A possible translation of the UML diagram above following the rules just mentioned is shown as follows:</p>
<p><img alt="tables to represent the data model mentioned above" src="_images/tables.png" /></p>
<p>It is worth mentioning that this is not the only possible way to translate the original UML data mode, and other paths can be followed to this respect.</p>
</section>
<section id="how-to-create-and-populate-a-table-with-pandas">
<h2>How to create and populate a table with Pandas<a class="headerlink" href="#how-to-create-and-populate-a-table-with-pandas" title="Permalink to this heading">#</a></h2>
<p>Pandas makes available specific methods that simplify the creation and population of database tables via <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>, and that take care also of running some database-related operations such as the <code class="docutils literal notranslate"><span class="pre">commit</span></code> shown above. The main tool to use to push a table into a SQLite database is the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_sql.html">method <code class="docutils literal notranslate"><span class="pre">to_sql</span></code></a> of the class <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>. However, before seen how to use it to populate a database, let us reorganise the original data provided in CSV about publications and venues in a series of Pandas data frames recalling the tabular structures introduced in the previous section.</p>
<section id="venue-id-table">
<h3>Venue-Id table<a class="headerlink" href="#venue-id-table" title="Permalink to this heading">#</a></h3>
<p>Let us start by creating the <code class="docutils literal notranslate"><span class="pre">VenueId</span></code> table. This can be done using one of the columns of the <a class="reference download internal" download="" href="_downloads/4aa59df752b73d2cbdf70c6251169020/01-venues.csv"><span class="xref download myst">CSV document describing venues</span></a>, i.e. the column <code class="docutils literal notranslate"><span class="pre">id</span></code>. Thus, we create a new sub-data frame containing only that column and we add an additional column defining the strings referring to the internal identifiers of each venue. The following code shows how to perform all these operations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">read_csv</span><span class="p">,</span> <span class="n">Series</span>

<span class="n">venues</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../01/01-venues.csv&quot;</span><span class="p">,</span> 
                  <span class="n">keep_default_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">dtype</span><span class="o">=</span><span class="p">{</span>
                      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                  <span class="p">})</span>

<span class="c1"># This will create a new data frame starting from &#39;venues&#39; one,</span>
<span class="c1"># and it will include only the column &quot;id&quot;</span>
<span class="n">venues_ids</span> <span class="o">=</span> <span class="n">venues</span><span class="p">[[</span><span class="s2">&quot;id&quot;</span><span class="p">]]</span>

<span class="c1"># Generate a list of internal identifiers for the venues</span>
<span class="n">venue_internal_id</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">venues_ids</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">venue_internal_id</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;venue-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>

<span class="c1"># Add the list of venues internal identifiers as a new column</span>
<span class="c1"># of the data frame via the class &#39;Series&#39;</span>
<span class="n">venues_ids</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;venueId&quot;</span><span class="p">,</span> <span class="n">Series</span><span class="p">(</span><span class="n">venue_internal_id</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">))</span>

<span class="c1"># Show the new data frame on screen</span>
<span class="n">venues_ids</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>venueId</th>
      <th>id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>venue-0</td>
      <td>1531-6912</td>
    </tr>
    <tr>
      <th>1</th>
      <td>venue-1</td>
      <td>1367-5931</td>
    </tr>
    <tr>
      <th>2</th>
      <td>venue-2</td>
      <td>9780470291092</td>
    </tr>
    <tr>
      <th>3</th>
      <td>venue-3</td>
      <td>1027-3662</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In practice, after reading the CSV, we create a new data frame with only the column <code class="docutils literal notranslate"><span class="pre">id</span></code> by using the command <code class="docutils literal notranslate"><span class="pre">&lt;data</span> <span class="pre">frame&gt;[[&lt;column</span> <span class="pre">name</span> <span class="pre">1&gt;,</span> <span class="pre">&lt;column</span> <span class="pre">name</span> <span class="pre">2&gt;,</span> <span class="pre">...]]</span></code>. In practice, this command will create a new sub-data frame using only the values in the columns specified.</p>
<p>Then, we have to define the internal identifiers for all the venues. To this end, we iterate over the rows of the new data frame and we compose a list of internal identifiers by concatenating the string <code class="docutils literal notranslate"><span class="pre">&quot;venue-&quot;</span></code> with the string of the values specified in the index of each row. Thus, we add that list (mediated via a <code class="docutils literal notranslate"><span class="pre">Series</span></code> of string values) into the data frame using the <a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.insert.html">method <code class="docutils literal notranslate"><span class="pre">insert</span></code></a>, which takes in input the position where to put the new column (<code class="docutils literal notranslate"><span class="pre">0</span></code> is the first position, <code class="docutils literal notranslate"><span class="pre">1</span></code> is the second position, etc.), the column name, and the values to associate to that column.</p>
</section>
<section id="tables-for-journals-and-books">
<h3>Tables for journals and books<a class="headerlink" href="#tables-for-journals-and-books" title="Permalink to this heading">#</a></h3>
<p>With this new table, we can start to create the two additional tables for journals and books. First of all, we create two new data frames containing only entities (i.e. rows) of the same type (e.g. journals) by using the method <code class="docutils literal notranslate"><span class="pre">query</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data frame of journals</span>
<span class="n">journals</span> <span class="o">=</span> <span class="n">venues</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;type == &#39;journal&#39;&quot;</span><span class="p">)</span>
<span class="n">journals</span>  <span class="c1"># Showing the data frame</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1531-6912</td>
      <td>Comparative and Functional Genomics</td>
      <td>journal</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1367-5931</td>
      <td>Current Opinion in Chemical Biology</td>
      <td>journal</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1027-3662</td>
      <td>Journal of Theoretical Medicine</td>
      <td>journal</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Then, for each row in the new data frame, we retrieve the associated <code class="docutils literal notranslate"><span class="pre">internalId</span></code> of each journal by looking at the table <code class="docutils literal notranslate"><span class="pre">venueId</span></code> created above. In this case, we can use the method <code class="docutils literal notranslate"><span class="pre">merge</span></code> to accomplish the task:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pandas</span> <span class="kn">import</span> <span class="n">merge</span>

<span class="n">df_joined</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">journals</span><span class="p">,</span> <span class="n">venues_ids</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
<span class="n">df_joined</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>type</th>
      <th>venueId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1531-6912</td>
      <td>Comparative and Functional Genomics</td>
      <td>journal</td>
      <td>venue-0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1367-5931</td>
      <td>Current Opinion in Chemical Biology</td>
      <td>journal</td>
      <td>venue-1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1027-3662</td>
      <td>Journal of Theoretical Medicine</td>
      <td>journal</td>
      <td>venue-3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Finally, the final journal table can be defined by selecting only two columns of the last merged data frame and by modifying the column name <code class="docutils literal notranslate"><span class="pre">venueId</span></code> in <code class="docutils literal notranslate"><span class="pre">internalId</span></code>, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">journals</span> <span class="o">=</span> <span class="n">df_joined</span><span class="p">[[</span><span class="s2">&quot;venueId&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]]</span>
<span class="n">journals</span> <span class="o">=</span> <span class="n">journals</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;venueId&quot;</span><span class="p">:</span> <span class="s2">&quot;internalId&quot;</span><span class="p">})</span>
<span class="n">journals</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>internalId</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>venue-0</td>
      <td>Comparative and Functional Genomics</td>
    </tr>
    <tr>
      <th>1</th>
      <td>venue-1</td>
      <td>Current Opinion in Chemical Biology</td>
    </tr>
    <tr>
      <th>2</th>
      <td>venue-3</td>
      <td>Journal of Theoretical Medicine</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The rename of a column is performed with the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.rename.html">method <code class="docutils literal notranslate"><span class="pre">rename</span></code></a>, that takes in input a dictonary with the named paramenter <code class="docutils literal notranslate"><span class="pre">columns</span></code>, where each key represent the old column name while the value is the new column name. The method returns a new data frame where the columns are renamed as specified.</p>
<p>A similar organisation can be provided also for books, by using the code specified above, customising it for handling books:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data frame of books</span>

<span class="n">books</span> <span class="o">=</span> <span class="n">venues</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;type == &#39;book&#39;&quot;</span><span class="p">)</span>
<span class="n">df_joined</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">books</span><span class="p">,</span> <span class="n">venues_ids</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
<span class="n">books</span> <span class="o">=</span> <span class="n">df_joined</span><span class="p">[[</span><span class="s2">&quot;venueId&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">]]</span>
<span class="n">books</span> <span class="o">=</span> <span class="n">books</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;venueId&quot;</span><span class="p">:</span> <span class="s2">&quot;internalId&quot;</span><span class="p">})</span>
<span class="n">books</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>internalId</th>
      <th>name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>venue-2</td>
      <td>Proceedings of the 5th Annual Conference on Co...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="tables-for-publications">
<h3>Tables for publications<a class="headerlink" href="#tables-for-publications" title="Permalink to this heading">#</a></h3>
<p>Similarly, all the other tables (i.e. <code class="docutils literal notranslate"><span class="pre">JournalArticles</span></code> and <code class="docutils literal notranslate"><span class="pre">BookChapters</span></code>) can be created using the same set of operations, but starting from the <a class="reference download internal" download="" href="_downloads/1a2bcaadfb618052c19b16227dd92a7a/01-publications.csv"><span class="xref download myst">CSV document containing publications</span></a>. First, we create a new column with all the internal identifiers for all publications, as shown as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">publications</span> <span class="o">=</span> <span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../01/01-publications.csv&quot;</span><span class="p">,</span> 
                        <span class="n">keep_default_na</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">dtype</span><span class="o">=</span><span class="p">{</span>
                            <span class="s2">&quot;doi&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;publication year&quot;</span><span class="p">:</span> <span class="s2">&quot;int&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;publication venue&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;issue&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;volume&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span>
                        <span class="p">})</span>

<span class="c1"># Create a new column with internal identifiers for each publication</span>
<span class="n">publication_internal_id</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">publications</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">publication_internal_id</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;publication-&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">idx</span><span class="p">))</span>
<span class="n">publications</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;internalId&quot;</span><span class="p">,</span> <span class="n">Series</span><span class="p">(</span><span class="n">publication_internal_id</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;string&quot;</span><span class="p">))</span>
<span class="n">publications</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>internalId</th>
      <th>doi</th>
      <th>title</th>
      <th>publication year</th>
      <th>publication venue</th>
      <th>type</th>
      <th>issue</th>
      <th>volume</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>publication-0</td>
      <td>10.1002/cfg.304</td>
      <td>Development of Computational Tools for the Inf...</td>
      <td>2003</td>
      <td>1531-6912</td>
      <td>journal article</td>
      <td>4</td>
      <td>4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>publication-1</td>
      <td>10.1016/s1367-5931(02)00332-0</td>
      <td>In vitro selection as a powerful tool for the ...</td>
      <td>2002</td>
      <td>1367-5931</td>
      <td>journal article</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>publication-2</td>
      <td>10.1002/9780470291092.ch20</td>
      <td>Mechanisms of Toughening in Ceramic Matrix Com...</td>
      <td>1981</td>
      <td>9780470291092</td>
      <td>book chapter</td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Then, we create the table for journal articles similarly to what we have done before:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data frame of journal articles</span>
<span class="n">journal_articles</span> <span class="o">=</span> <span class="n">publications</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;type == &#39;journal article&#39;&quot;</span><span class="p">)</span>
<span class="n">df_joined</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">journal_articles</span><span class="p">,</span> <span class="n">venues_ids</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;publication venue&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
<span class="n">journal_articles</span> <span class="o">=</span> <span class="n">df_joined</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;internalId&quot;</span><span class="p">,</span> <span class="s2">&quot;doi&quot;</span><span class="p">,</span> <span class="s2">&quot;publication year&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;issue&quot;</span><span class="p">,</span> <span class="s2">&quot;volume&quot;</span><span class="p">,</span> <span class="s2">&quot;venueId&quot;</span><span class="p">]]</span>
<span class="n">journal_articles</span> <span class="o">=</span> <span class="n">journal_articles</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;publication year&quot;</span><span class="p">:</span> <span class="s2">&quot;publicationYear&quot;</span><span class="p">,</span>
    <span class="s2">&quot;venueId&quot;</span><span class="p">:</span> <span class="s2">&quot;publicationVenue&quot;</span><span class="p">})</span>
<span class="n">journal_articles</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>internalId</th>
      <th>doi</th>
      <th>publicationYear</th>
      <th>title</th>
      <th>issue</th>
      <th>volume</th>
      <th>publicationVenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>publication-0</td>
      <td>10.1002/cfg.304</td>
      <td>2003</td>
      <td>Development of Computational Tools for the Inf...</td>
      <td>4</td>
      <td>4</td>
      <td>venue-0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>publication-1</td>
      <td>10.1016/s1367-5931(02)00332-0</td>
      <td>2002</td>
      <td>In vitro selection as a powerful tool for the ...</td>
      <td>3</td>
      <td>6</td>
      <td>venue-1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Similarly, we create the table for book chapters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data frame of book chapters</span>
<span class="n">book_chapters</span> <span class="o">=</span> <span class="n">publications</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;type == &#39;book chapter&#39;&quot;</span><span class="p">)</span>
<span class="n">df_joined</span> <span class="o">=</span> <span class="n">merge</span><span class="p">(</span><span class="n">book_chapters</span><span class="p">,</span> <span class="n">venues_ids</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;publication venue&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;id&quot;</span><span class="p">)</span>
<span class="n">book_chapters</span> <span class="o">=</span> <span class="n">df_joined</span><span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;internalId&quot;</span><span class="p">,</span> <span class="s2">&quot;doi&quot;</span><span class="p">,</span> <span class="s2">&quot;publication year&quot;</span><span class="p">,</span> <span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;venueId&quot;</span><span class="p">]]</span>
<span class="n">book_chapters</span> <span class="o">=</span> <span class="n">book_chapters</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s2">&quot;publication year&quot;</span><span class="p">:</span> <span class="s2">&quot;publicationYear&quot;</span><span class="p">,</span>
    <span class="s2">&quot;venueId&quot;</span><span class="p">:</span> <span class="s2">&quot;publicationVenue&quot;</span><span class="p">})</span>
<span class="n">book_chapters</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>internalId</th>
      <th>doi</th>
      <th>publicationYear</th>
      <th>title</th>
      <th>publicationVenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>publication-2</td>
      <td>10.1002/9780470291092.ch20</td>
      <td>1981</td>
      <td>Mechanisms of Toughening in Ceramic Matrix Com...</td>
      <td>venue-2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="adding-the-tables-to-the-database">
<h3>Adding the tables to the database<a class="headerlink" href="#adding-the-tables-to-the-database" title="Permalink to this heading">#</a></h3>
<p>As anticipated before, adding a table to a database is done, in Pandas, using the <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code> method <code class="docutils literal notranslate"><span class="pre">to_sql</span></code>. This method takes in input two mandatory parameters (identifying the name of the table in the database and the database connection) plus a series of optional named parameters, among which the parameter <code class="docutils literal notranslate"><span class="pre">if_exists</span></code> that, when set to <code class="docutils literal notranslate"><span class="pre">&quot;replace&quot;</span></code>, replaces the values in an existing database table having the same name with the new data, and the parameter <code class="docutils literal notranslate"><span class="pre">index</span></code> that, when set to <code class="docutils literal notranslate"><span class="pre">False</span></code>, does not add the data frame index in the database. Thus, adding the five tables to the SQLite database created at the very beginning can be done running the following commands:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">connect</span><span class="p">(</span><span class="s2">&quot;publications.db&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">con</span><span class="p">:</span>
    <span class="n">venues_ids</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;VenueId&quot;</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">journals</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;Journal&quot;</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">books</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;Book&quot;</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">journal_articles</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;JournalArticle&quot;</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">book_chapters</span><span class="o">.</span><span class="n">to_sql</span><span class="p">(</span><span class="s2">&quot;BookChapter&quot;</span><span class="p">,</span> <span class="n">con</span><span class="p">,</span> <span class="n">if_exists</span><span class="o">=</span><span class="s2">&quot;replace&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "mary-lev/data_science",
            ref: "gh-pages",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="03-Introduction_to_Pandas.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">7. Introduction to Pandas</p>
      </div>
    </a>
    <a class="right-next"
       href="05-Configuring_and_populating_a_graph_database.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">11. Configuring and populating a graph database</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sqlite">SQLite</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#create-a-new-database">Create a new database</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#from-a-diagram-to-tables">From a diagram to tables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-create-and-populate-a-table-with-pandas">How to create and populate a table with Pandas</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#venue-id-table">Venue-Id table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-for-journals-and-books">Tables for journals and books</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tables-for-publications">Tables for publications</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adding-the-tables-to-the-database">Adding the tables to the database</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Prof. Silvio Peroni
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>